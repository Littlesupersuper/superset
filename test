import org.apache.spark.sql.Dataset;
import org.apache.spark.sql.Row;
import org.apache.spark.sql.SparkSession;
import org.apache.spark.sql.Encoders;
import org.apache.spark.sql.types.DataTypes;

import java.util.Arrays;

public class CreateJsonFieldDataset {
    public static void main(String[] args) {
        // 初始化 SparkSession
        SparkSession spark = SparkSession.builder()
                .appName("Create JSON Field Dataset")
                .master("local[*]")
                .getOrCreate();

        // 准备 JSON 字符串数据
        String json1 = "{\"name\": \"Alice\", \"age\": 25}";
        String json2 = "{\"name\": \"Bob\", \"age\": 30}";
        String json3 = "{\"name\": \"Charlie\", \"age\": 35}";

        // 创建 Dataset，初始字段名称默认为 "value"
        Dataset<String> jsonDataset = spark.createDataset(
                Arrays.asList(json1, json2, json3),
                Encoders.STRING()
        );

        // 重命名字段为 "column A"
        Dataset<Row> renamedDataset = jsonDataset
                .withColumnRenamed("value", "column A");

        // 展示 Dataset
        renamedDataset.show(false);

        // 打印模式（Schema）
        renamedDataset.printSchema();

        // 停止 SparkSession
        spark.stop();
    }
}